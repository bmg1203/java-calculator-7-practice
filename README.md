# 1주차 : 문자열 덧셈 계산기

## ✨ 기능 요구사항

> 입력한 문자열에서 숫자를 추출하여 더하는 계산기를 구현한다.

- 쉼표(,) 또는 콜론(:)을 구분자로 가지는 문자열을 전달하는 경우 구분자를 기준으로 분리한 각 숫자의 합을 반환한다.
    - 예: "" => 0, "1,2" => 3, "1,2,3" => 6, "1,2:3" => 6
- 앞의 기본 구분자(쉼표, 콜론) 외에 커스텀 구분자를 지정할 수 있다.
    - 커스텀 구분자는 문자열 앞부분의 "//"와 "\n" 사이에 위치하는 문자를 커스텀 구분자로 사용한다.
    - 예를 들어 "//;\n1;2;3"과 같이 값을 입력할 경우 커스텀 구분자는 세미콜론(;)이며, 결과 값은 6이 반환되어야 한다.
- 사용자가 잘못된 값을 입력할 경우 IllegalArgumentException을 발생시킨 후 애플리케이션은 종료되어야 한다.

### 🌟 구현한 세부 기능

- 입출력
    - [x] 입력 형식 지정 (덧셈할 문자열을 입력해 주세요.)
    - [x] 사용자 입력 받기
    - [x] 출력 형식 지정 (결과 : 숫자)
    - [x] 결과 출력
- 입력 문자열 검증
    - [x] null, 빈 문자열이면 0을 반환한다.
    - [x] 유효한 형식 이외에 잘못된 형식일 경우 IllegalArgumentException을 발생시키고 애플리케이션을 종료시킨다.
- 구분자 분리
    - [x] 쉼표(,), 콜론(:)을 구분자로 가지는 문자열을 전달하는 경우 구분자를 기준으로 분리한다.
    - [x] `"//;\n1;2;3"` 와 같이 커스텀 구분자의 경우, 해당 구분자를 기준으로 분리한다.
- 숫자 추출해 더하기
    - [x] 분리된 문자열에서 숫자를 추출해 더한다.

## 📁 파일 구조

```
src
└── main
    └── java
        └── calculator
            ├── controller
            │   └── CalculatorController
            ├── service
            │   └── CalculateService
            ├── util
            │   ├── Constants
            │   └── NumberParser
            ├── view
            │   ├── Input
            │   ├── Output
            └── Application
└── test
    └── java
        └── calculator
            └── ApplicationTest
```

1. Controller
    - 사용자의 입력을 받아서 서비스 계층에 전달하고, 서비스 계층으로부터 결과를 받아 출력하는 역할을 한다.
    - `Input` → `CalculateService` → `Output`
2. Service
    - 숫자를 추출하고, 덧셈 연산을 수행하는 비즈니스 로직을 담당한다.
3. Util
    - `Constants` : 정규표현식, 에러메시지 등 애플리케이션에서 사용되는 상수값을 정의해 재사용이 가능하게 한다.
    - `NumberParser` : 입력된 문자열을 숫자로 변환하고, 유효성을 검증하는 기능을 담당한다.
4. View
    - `Input` : 사용자에게 입력을 받는다.
    - `Output` : 사용자에게 결과를 출력한다.
5. Application
    - 애플리케이션의 진입점 역할을 하며, 프로그램을 실행한다.

### 🤔 입출력 인터페이스에 대한 고민

처음에는 MVC 패턴에 따라 Model, View, Controller가 있었고, View는 Input과 InputImpl, Ouput과 OutputImpl이 있었다. 확장성을 고려해 인터페이스와 구현체를
만들었지만, 사실상
입력과 출력은 한 줄짜리에 불과했고 인터페이스를 만드는 것은, 실행시간을 늘릴 뿐 애플리케이션 설계에 불필요하다는 결론을 냈다.

실제로, 테스트 코드를 실행했을 때 기존에는 **`900ms ~ 1s`**가 나왔지만, 인터페이스와 구현체를 없애고 입출력을 각각의 클래스에서 처리했을 때, **`700~800ms`**로 실행시간이 감소한 것을
확인했다.

구현체를 거치지 않았으니, 당연한 결과였겠지만 이 작은 프로그램에서 0.1~0.2초 정도를 줄인 것은 꽤 유의미한 결과라고 생각하기 때문에 확장성만을 고려한 인터페이스 설계는 삭제하는 것이 맞겠다는 결론을
내렸다.

| 인터페이스, 구현체 사용                                                                             | 입출력 클래스 사용                                                                                |
|-------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------|
| ![image](https://github.com/user-attachments/assets/9259710a-bbcb-4403-b88b-f713eee27ca5) | ![image](https://github.com/user-attachments/assets/76bfee93-5c13-44bf-8cbd-e17c77e7bc06) |

### 🪄 매직 넘버

정규표현식, 입출력 형식과 같은 것들을 모두 코드에 바로 넣었었는데, 프리코스 디스코드 커뮤니티와 다른 분들이 올리신 코드를 보며 매직 넘버는 사용을 지양해야 한다는 것을 알게 되었다.

처음에는 단순히 해당 파일 상단에 매직 넘버를 변수로 관리하면 되는 줄 알았는데, 이 값을 여러 곳에서 사용하게 된다면 변경이 일어날 때 하나씩 다 바꿔줘야 한다는 문제점이 있다는 것을 알게 되어 Constant
클래스를 만들어 관리해주었다.

또한, 에러 메시지도 하나의 클래스를 만들어 한 곳에서 custom error message를 관리해주도록 변경하였다.

### 🤔 Custom 구분자 추출 방법 고민

`//;\n1;2;3` 의 입력 형태 일 때, custom 구분자를 추출해주기 위한 방법을 생각해봤다.

1. **처음 앞 두 문자가 //이고, 한 칸 건너뛰고 \n이라면, 그 사이의 값을 추출하는 방법**
    - 장점 : 복잡한 정규식을 쓰지 않아도 되므로 성능이 더 좋다.
    - 단점 : 입력 패턴이 달라진다면, 코드를 처음부터 다시 짜야 한다.
2. **정규표현식 사용**

   `//(.*?)\n(.*)` 이런 식으로 정규표현식을 만들면, //과 \n 사이에 있는 값과 \n의 값을 추출할 수 있다.

    - 장점 : 코드를 간결하게 유지할 수 있고, 특정 패턴을 추출할 때 유용함
    - 단점 : 복잡해질수록 코드를 읽기 힘들고 잘못된 정규식을 입력할 수 있다.

정규표현식을 사용함으로써 구분자와 뒷글자들을 바로 추출할 수 있기 때문에 정규표현식을 선택했다.

### 📍 정규표현식 트러블 슈팅

처음에는, `//(.*?)\n(.*)` 이렇게 했었는데 escape 처리를 해줘야 되는 걸 깨닫고 `//(.*?)\\n(.*)` 이렇게 해줬다..

그런데도 계속 안 돼서 찾아보니

- 정규식에서 `\n`을 사용하려면 `\\n`을 해줘야 한다.
- Java에서는 백슬래시 하나를 표현하려면 두 개의 백슬래시(`\\`)를 사용해야 한다.
- 따라서 **정규식에서 `\n`을 표현하기 위해 Java에서**는 `\\\\n`으로 작성해야 한다.

즉, `\\\\n`은 정규식 `\\n`으로 인식되므로 `\n`이 들어간 걸 찾는다.